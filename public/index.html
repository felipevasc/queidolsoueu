<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>K-Pop Guess Who</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;700;900&display=swap" rel="stylesheet">
    <!-- FontAwesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

    <link rel="stylesheet" href="style.css">
    <script src="/socket.io/socket.io.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
</head>

<body>

    <div id="app">
        <section id="login-screen" class="active">
            <div class="glass-panel">
                <h1>üå∏ K-Pop Guess üå∏</h1>
                <input type="text" id="username" placeholder="Usu√°rio">
                <input type="password" id="password" placeholder="Senha">
                <button onclick="login()">Entrar / Registrar</button>
            </div>
        </section>

        <section id="main-menu" class="hidden">
            <header>
                <div class="user-info">
                    <div class="avatar-circle" id="my-avatar-display"></div>
                    <div>
                        <span id="display-username">User</span>
                        <div class="coins">ü™ô <span id="display-coins">0</span></div>
                    </div>
                </div>
                <button onclick="openSettings()">‚öôÔ∏è</button>
            </header>

            <div class="menu-grid">
                <button class="big-btn pink" onclick="showScreen('games-menu')">üéÆ Jogos</button>
                <button class="big-btn white" onclick="showScreen('shop-screen'); fetchShopData()">üõçÔ∏è Loja</button>
                <button class="big-btn white" onclick="showScreen('collection-screen'); fetchShopData()">üì∏
                    Photocard</button>
            </div>
        </section>

        <section id="games-menu" class="hidden">
            <button class="back-btn" onclick="showScreen('main-menu')">‚¨Ö Voltar</button>
            <h2>Escolha um Jogo</h2>
            <div class="menu-grid">
                <button class="big-btn pink" onclick="showScreen('lobby-screen'); refreshRooms()">‚ùì Que Idol sou eu?</button>
                <button class="big-btn white" onclick="showScreen('wordle-screen'); initWordleGame()">üîê Adivinhe a senha</button>
            </div>
        </section>

        <section id="lobby-screen" class="hidden">
            <button class="back-btn" onclick="showScreen('games-menu')">‚¨Ö Voltar</button>
            <h2>Salas Abertas</h2>
            <div id="rooms-list"></div>
            <div class="create-room-box">
                <input type="text" id="room-name" placeholder="Nome da Sala">
                <button onclick="createRoom()">Criar Sala +</button>
            </div>
        </section>

        <section id="shop-screen" class="hidden">
            <button class="back-btn" onclick="showScreen('main-menu')">‚¨Ö Voltar</button>
            <h2>Loja de Avatares</h2>
            <div id="shop-grid" class="cards-grid"></div>
        </section>

        <section id="collection-screen" class="hidden">
            <button class="back-btn" onclick="showScreen('main-menu')">‚¨Ö Voltar</button>
            <h2>Meus Photocards</h2>
            <p style="text-align:center; font-size:0.8em; color:#666">Clique para equipar</p>
            <div id="collection-grid" class="cards-grid"></div>
        </section>

        <section id="wordle-screen" class="hidden">
            <button class="back-btn" onclick="showScreen('games-menu')">‚¨Ö Voltar</button>

            <div id="wordle-game-container" class="wordle-container">
                <div class="wordle-header">
                    <h1 class="title-3d">K-Comeback</h1>
                    <p>Adivinhe a Palavra em 5 Tentativas!</p>
                </div>

                <!-- Seletores de Tema e Dificuldade -->
                <div class="wordle-controls">
                    <div class="wordle-control-group">
                        <label for="theme-select">Tema</label>
                        <select id="theme-select" class="kpop-select" onchange="initWordleGame()">
                            <option value="GERAL">Geral (Todos)</option>
                            <option value="K-POP" selected>Cultura K-POP</option>
                            <option value="COMIDA">Comidas</option>
                            <option value="ANIMAL">Animais</option>
                            <option value="LUGAR">Lugares</option>
                            <option value="FAMA">Nomes de Famosos</option>
                        </select>
                    </div>
                    <div class="wordle-control-group">
                        <label for="difficulty-select">Dificuldade</label>
                        <select id="difficulty-select" class="kpop-select" onchange="initWordleGame()">
                            <option value="FACIL">F√°cil (at√© 4 letras)</option>
                            <option value="MEDIO" selected>M√©dio (4 a 6 letras)</option>
                            <option value="DIFICIL">Dif√≠cil (> 6 letras)</option>
                        </select>
                    </div>
                </div>

                <!-- Grid do Jogo (Ajustado dinamicamente via JS) -->
                <div id="word-grid" class="wordle-grid-container">
                    <!-- As c√©lulas ser√£o preenchidas via JavaScript -->
                </div>

                <!-- √Årea de Dicas -->
                <div class="wordle-hint-box">
                    <h3>Dicas K-Helper</h3>
                    <div id="hint-display" class="wordle-hint-text">
                        Selecione uma op√ß√£o de dica abaixo.
                    </div>
                </div>

                <!-- Bot√µes de A√ß√£o -->
                <div class="wordle-actions">
                    <button id="btn-submit-wordle" class="kpop-button" disabled>
                        <i class="fas fa-paper-plane"></i> Enviar (Enter)
                    </button>
                    <button id="btn-hint-wordle" class="kpop-button btn-gradient-pink">
                        <i class="fas fa-lightbulb"></i> Pedir Dica
                    </button>
                    <button id="btn-roulette-wordle" class="kpop-button btn-gradient-purple">
                        <i class="fas fa-dice"></i> Rodar Roleta
                    </button>
                </div>

                <div class="wordle-restart">
                    <button id="btn-restart-wordle" onclick="initWordleGame()">
                        <i class="fas fa-redo-alt"></i> <span>Novo Comeback!</span>
                    </button>
                </div>

                <!-- O input escondido para for√ßar o teclado virtual no celular -->
                <input type="text" id="wordle-hidden-input" maxlength="10" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" inputmode="text" pattern="[a-zA-Z]*">
            </div>
        </section>

        <!-- Modal de Fim de Jogo / Mensagens Wordle -->
        <div id="wordle-modal" class="modal-overlay hidden">
            <div class="modal-box">
                <h2 id="wordle-modal-title" class="modal-title title-3d"></h2>
                <p id="wordle-modal-message" class="modal-msg"></p>
                <p id="wordle-modal-secret-word" class="modal-secret"></p>
                <button id="wordle-modal-close-btn" class="kpop-button" onclick="closeWordleModal()">
                    Obrigada, Tchau!
                </button>
            </div>
        </div>

        <section id="waiting-room" class="hidden">
            <h2>Aguardando Oponente...</h2>
            <div class="loader"></div>
        </section>

        <section id="game-screen" class="hidden game-layout">

            <div id="hud-top" class="hud-panel">
                <div class="hud-content">
                    <div class="player-identity">
                        <div class="avatar-frame">
                            <img id="my-game-avatar" src="" alt="Eu">
                        </div>
                        <div class="player-text">
                            <span id="my-game-name" class="p-name">Eu</span>
                            <span class="score-badge">Derrubados: <span id="my-score">0</span>/9</span>
                        </div>
                    </div>

                    <div class="secret-card-mini">
                        <span>SEU ALVO:</span>
                        <div class="mini-card-img">
                            <img id="my-secret-card" src="">
                            <div class="mini-label" id="my-secret-name">?</div>
                        </div>
                    </div>

                    <button id="finish-turn-btn" onclick="finishTurn()">‚úÖ Confirmar</button>
                </div>
            </div>

            <div id="game-board-container">
                <div id="game-board" class="board-grid"></div>
            </div>

            <div id="hud-bottom" class="hud-panel">
                <div class="hud-content opponent-content">
                    <div class="player-identity">
                        <div class="avatar-frame">
                            <img id="opp-avatar" src="" alt="Opp">
                        </div>
                        <div class="player-text">
                            <span id="opp-name" class="p-name">Oponente</span>
                            <span class="score-badge">Derrubados: <span id="opp-score">0</span>/9</span>
                        </div>
                    </div>
                    <div class="turn-status" id="turn-msg">Aguardando...</div>
                </div>
            </div>
        </section>

        <div id="win-overlay" class="hidden">
            <div class="win-modal">
                <h1 id="win-title">FIM DE JOGO</h1>
                <h2 id="winner-announce">Vencedor: ???</h2>

                <div class="reveal-section">
                    <div class="reveal-card">
                        <p>O Vencedor era:</p>
                        <img id="reveal-winner-img" src="">
                        <span id="reveal-winner-name">...</span>
                    </div>
                    <div class="reveal-card grayscale">
                        <p>O Perdedor era:</p>
                        <img id="reveal-loser-img" src="">
                        <span id="reveal-loser-name">...</span>
                    </div>
                </div>

                <p class="coins-gain" id="coins-msg"></p>
                <button class="big-btn pink" onclick="resetToLobby()">Voltar ao Lobby</button>
            </div>
        </div>

        
    </div>

    <script src="client.js"></script>
    <script src="wordle.js"></script>
</body>

</html>